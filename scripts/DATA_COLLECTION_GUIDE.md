# データ収集・変換ガイド

## 📋 概要

このガイドでは、都道府県の家賃データを収集し、`prefectures.json` に追加する方法を説明します。

---

## 🎯 データ収集方法

### 1. データソース

**推奨サイト**: [SUUMO](https://suumo.jp/) または [ホームズ](https://www.homes.co.jp/)

### 2. 収集するデータ

各都道府県について、以下の 4 つの間取りタイプの家賃相場を収集:

- ワンルーム・1K・1DK
- 1LDK・2K・2DK
- 2LDK・3K・3DK
- 3LDK・4K・4DK

### 3. データ形式

`data/tokyo_data.md` のような形式でマークダウンファイルを作成:

```markdown
<!-- 東京都のデータ -->

<!-- ワンルーム・1k・1dk -->

千代田区 15.18 万円
中央区 13.59 万円
港区 15.55 万円
...

<!-- 1LDK・2K・2DK -->

千代田区 23.31 万円
中央区 22.58 万円
港区 29.05 万円
...

<!-- 2LDK・3K・3DK -->

千代田区 39.85 万円
...

<!-- 3LDK・4K・4DK -->

千代田区 62.96 万円
...
```

**重要なポイント**:

- 各エリアは 4 つの間取りタイプすべてのデータが必要
- データが不完全なエリアは自動的にスキップされます
- 形式: `エリア名 金額 万円`

---

## 🛠️ データ変換手順

### ステップ 1: データファイル作成

`data/` ディレクトリに都道府県名のマークダウンファイルを作成:

```bash
# 例: 大阪府のデータ
touch data/osaka_data.md
```

### ステップ 2: データ入力

上記の形式でデータを入力します。

### ステップ 3: 変換スクリプト実行

```bash
npx tsx scripts/convert-rent-data.ts
```

**出力例**:

```
📖 tokyo_data.md を読み込み中...
📍 セクション: ワンルーム
  ✓ 千代田区: oneRoom = 151,800円
  ✓ 中央区: oneRoom = 135,900円
  ...
✅ 40 件のエリアデータを変換しました
✅ 東京都のデータを更新しました
💾 prefectures.json に保存しました

📊 変換結果サマリー:
総エリア数: 40
平均家賃範囲: 100,400円 〜 367,200円
```

### ステップ 4: 確認

```bash
git diff data/prefectures.json
```

データが正しく追加されているか確認します。

---

## 📝 新しい都道府県を追加する場合

### 1. スクリプトの修正

`scripts/convert-rent-data.ts` の `main()` 関数を修正:

```typescript
// 大阪府の例
const osakaDataPath = path.join(dataDir, "osaka_data.md");
const areas = parseMarkdownData(osakaDataPath);

// 大阪府のデータを更新
const osakaIndex = prefectures.findIndex((p) => p.slug === "osaka");
if (osakaIndex !== -1) {
  prefectures[osakaIndex].areas = areas;
}
```

### 2. 座標データの追加

主要エリアの座標を `COORDINATES` オブジェクトに追加:

```typescript
const COORDINATES: Record<string, { lat: number; lng: number; station: string }> = {
  // 大阪府の例
  '北区': { lat: 34.7024, lng: 135.5023, station: '梅田駅' },
  '中央区': { lat: 34.6777, lng: 135.5109, station: '心斎橋駅' },
  ...
};
```

---

## ⚠️ 注意点

### データの正確性

- 最新のデータを使用してください
- 古いデータは SEO に悪影響を与える可能性があります

### データの完全性

- 4 つの間取りタイプすべてのデータが必要です
- 不完全なエリアは自動的にスキップされます

### 更新頻度

- 年 1 回の更新を推奨
- 家賃相場は変動するため、定期的な更新が重要です

---

## 🚀 次のステップ

1. **データ収集**: 残り 42 都道府県のデータを収集
2. **変換**: スクリプトで JSON に変換
3. **デプロイ**: サーバーにデプロイ
4. **SEO 効果測定**: Google Search Console で効果を確認

---

## 📊 期待される効果

- **ページ数**: 10 → 50 以上（5 倍）
- **SEO 効果**: ロングテールキーワードでの検索流入増加
- **ユーザー体験**: 全国どこからでも利用可能

---

## 💡 ヒント

### 効率的なデータ収集

1. SUUMO の都道府県別ページを開く
2. 間取りタイプごとにフィルター
3. 市区町村別の平均家賃をコピー
4. マークダウンファイルに貼り付け

### データの検証

```bash
# 変換前にデータ数を確認
grep "万円" data/tokyo_data.md | wc -l
# 期待値: エリア数 × 4（間取りタイプ）
```

---

**作成日**: 2025 年 12 月 4 日
**最終更新**: 2025 年 12 月 4 日
